package proj4j;

import com.esri.core.geometry.*;
import org.junit.Test;
import org.osgeo.proj4j.*;
import xyz.SimpleWKTExamples;
import xyz.TestResources;

/**
 *
 * Just messing around with the proj4j build
 *
 * Created by willtemperley@gmail.com on 24-Nov-16.
 */
public class ProjectGeometryTest {

    @Test
    public void run() {

        final String WGS84_PARAM = "+title=long/lat:WGS84 +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees";

        CoordinateTransformFactory ctFactory = new CoordinateTransformFactory();
        CRSFactory csFactory = new CRSFactory();
        CoordinateReferenceSystem WGS84 = csFactory.createFromParameters("WGS84", WGS84_PARAM);
        CoordinateReferenceSystem crs = csFactory.createFromName("EPSG:32630");
        CoordinateTransform trans = ctFactory.createTransform(WGS84, crs);
        CoordinateTransform trans_1 = ctFactory.createTransform(crs, WGS84);

        //fwd and reverse
        GeometryProjector polylineProjector = new GeometryProjector(trans);
        GeometryProjector polygonProjector = new GeometryProjector(trans_1);

        Polyline polyline = (Polyline) TestResources.getUkWiggle().getGeometry();
//        export(polyline);

//        Geometry execute = OperatorBuffer.local().execute(polyline, null, 0.08333, null);
//        export(execute);

        Polyline transformed = polylineProjector.transform(polyline);
//
//        System.out.println("transformed = " + transformed);
//
        Geometry execute = OperatorBuffer.local().execute(transformed, null, 10000, null);
//        System.out.println("execute = " + execute);
//
        Polygon transform = polygonProjector.transform((Polygon) execute);

        export(transform);

        /*
        {"type":"Polygon","coordinates":[[[55.001213299038724,-0.8908912858067208],[55.05908674620903,-0.8888239292428616],[55.116691505865354,-0.8829516859563783],[55.173781083617754,-0.873301762809926],[55.23011146611737,-0.859917504576304],[55.28544216247011,-0.8428581719556754],[55.33953722536802,-0.8221986521430421],[55.39216624757388,-0.7980291038875671],[55.44310532961666,-0.7704545392600193],[55.49213801479608,-0.7395943445934763],[55.53905618785206,-0.7055817432849865],[55.5836609339219,-0.6685632033397638],[55.62576335468327,-0.628697792707381],[55.665185338857206,-0.5861564855988027],[55.701760284520546,-0.5411214230880139],[55.73533377094668,-0.4937851313913051],[55.76576417795386,-0.4443497012856762],[55.792923250989574,-0.39302593217529747],[55.81669661041456,-0.340032444346005],[55.83698420367043,-0.28559476296427383],[55.853700699218905,-0.22994437738244147],[55.86677582132875,-0.1733177793083618],[55.87615462495943,-0.11595548338950433],[55.88179771014836,-0.058101033749067575],[55.88368137545474,0],[55.88179771014836,0.058101033749067575],[55.87615462495943,0.11595548338950433],[55.86677582132875,0.1733177793083618],[55.853700699218905,0.22994437738244147],[55.83698420367043,0.28559476296427383],[55.81669661041456,0.340032444346005],[55.792923250989574,0.39302593217529747],[55.76576417795386,0.4443497012856762],[55.759136524787756,0.4557492729152695],[1.9295057621801752,53.503915169413666],[1.9020186150398493,53.52207429071761],[1.8666393263723295,53.54279881918565],[1.8316907903862703,53.56032612282715],[1.7973996663934213,53.57459014483076],[1.7639737397968813,53.58553806907135],[1.7315991946698315,53.5931303027311],[1.7004382709996109,53.59734041021179],[1.6706273773062656,53.598155007073366],[1.6422757222682511,53.59557362307734],[1.6154645190403711,53.58960854336255],[1.590246803208236,53.580284636305905],[1.566647890016337,53.56763917571667],[1.5446664790195066,53.551721663690536],[1.5242763951769096,53.53259365875089],[1.5054289353140822,53.51032861189098],[1.488055768613426,53.48501171088827],[1.4720723202287385,53.45673973089586],[1.457381549157076,53.42562088694921],[1.443878016025991,53.391774681780525],[1.4314521242765075,53.355331740344546],[1.4199944100248096,53.31643362084043],[1.409399752177224,53.27523259087664],[1.3995713754492811,53.23189135684513],[1.3904245248588354,53.186582734601224],[1.3818897008344142,53.13948925020646],[1.373915358875185,53.09080266076362],[1.3664699960685889,53.040723387206285],[1.359543567893761,52.98945985321627],[1.3531482016535696,52.93722772712051],[1.3473181965640788,52.88424906653654],[1.342109323946694,52.83075136855195],[1.3375974631287044,52.7769665311952],[1.3338766286776065,52.723129734747275],[1.3310564617345857,52.66947825393474],[1.3292592719170468,52.616250214129714],[1.3286167261697015,52.5636833062919],[1.3292662869070733,52.51201347646562],[1.331347503848971,52.461473606182324],[1.3349982623282743,52.412292200115836],[1.3403510859165277,52.36469209683704],[1.3475295834555931,52.318889217566394],[1.3566451205668593,52.27509136650217],[1.367793784039112,52.233497094690655],[1.3810536947832013,52.194294637591454],[1.3964827118697232,52.15766093456183],[1.40884053374523,52.13317988028631],[1.518589022336101,51.960989056869344],[1.3073595185968934,51.388980165870755],[1.3094348311707378,51.387957057556555],[1.3321059076878994,51.375010496564634],[1.3545736759651015,51.35883123392437],[1.3764986128247896,51.33946134192737],[1.3975340033183903,51.31695445433095],[1.4173328583225628,51.291376176122256],[1.4355550512141817,51.26280450011261],[1.4518744899499114,51.23133020916979],[1.465986134129147,51.197057240870556],[1.477612666599162,51.16010299024797],[1.4865106360721532,51.12059852620297],[1.4924759009299549,51.07868869809153],[1.4953482244187024,51.03453211097892],[1.4950148969855341,50.988300951000724],[1.4914132915085851,50.94018064606971],[1.4845322903336555,50.890369351653355],[1.4744125579301992,50.839077256322305],[1.4611456681288897,50.786525707009616],[1.4448721288502515,50.73294615919617],[1.4257783786255613,50.67857896231695],[1.4040928568804556,50.623671995357874],[1.380081272952212,50.56847917169704],[1.354041216478498,50.51325883559174],[1.3262962637411526,50.45827207521983],[1.2971897406833885,50.403780978792646],[1.2670783038132578,50.35004686095357],[1.2363254954787959,50.29732848649512],[1.2052954206566546,50.245880317434015],[1.1743466791941957,50.19595080778099],[1.143826671228306,50.1477807680503],[1.114066375163247,50.101601818812455],[1.0853756780020951,50.05763494954414],[1.0580393178226815,50.01608919581327],[1.0323134785155883,49.97716044458773],[1.0084230582001106,49.9410303742917],[0.9865596155192075,49.907865533253904],[0.9668799826758886,49.87781655747982],[0.9495055208705157,49.85101752629195],[0.9345219828705486,49.82758545235826],[0.921979938821622,49.807619900987184],[0.9118957150312738,49.79120273230805],[0.9042527911844598,49.77839795906484],[0.8990035990918273,49.76925171220185],[0.8960716653909253,49.76379230617631],[0.8953540413617224,49.76203039595388],[0.8967239649139583,49.763959217880654],[0.900033702590933,49.76955490703595],[0.9051175228639783,49.778776884204255],[0.9111218589835787,49.79024993318702],[1.7253397213765937,50.3373653968556],[19.185306144764592,39.430112823824864],[19.198780876523962,39.4188193719236],[19.24948992572674,39.37967330358484],[19.303327222930893,39.3431432111173],[19.36006866999974,39.30938079540156],[19.419479140247496,39.27852650165466],[19.481313349615384,39.25070898371029],[19.545316752335733,39.22604460737429],[19.61122645982661,39.2046369942381],[19.678772181647116,39.186576607364174],[19.747677187394853,39.17194038028555],[19.81765928844336,39.16079139078299],[19.888431838398077,39.153178580916006],[19.959704751096385,39.14913652478287],[20.03118553489131,39.14868524547084],[20.10258034184172,39.15183008262487],[20.173595030285544,39.15856161201283],[20.243936239099913,39.1688556183931],[20.313312471753868,39.1826731228985],[20.381435188039525,39.1999604660349],[20.448019901127985,39.220649447255184],[20.512787277338973,39.24465752190928],[20.57546423574292,39.27188805618764],[20.635785044431145,39.302230640471095],[20.693492409999756,39.335561461274274],[20.74833855649734,39.37174373172279],[20.800086289789682,39.410628180240295],[20.848510043000328,39.45205359683782],[20.893396898398034,39.495847436099204],[20.934547580825434,39.54182647564264],[20.971777417502132,39.58979752851221],[21.004917258796024,39.63955820761605],[21.03381435434367,39.69089773998197],[21.05833317872122,39.74359782824893],[21.078356200726894,39.79743355645638],[21.093784590242358,39.85217433683606],[21.104538856600204,39.90758489395371],[21.110559412404132,39.96342628219757],[21.111807056835836,40.019456932266124],[21.10826337264395,40.07543372197652],[21.0999310312508,40.13111306639892],[21.086834000739813,40.18625202202626],[21.06901765190133,40.24060939941863],[21.046548758023555,40.29394687851906],[21.019515384716104,40.34603012063107],[20.988026666748773,40.396629870880496],[20.9522124696725,40.44552304486],[20.912222934859336,40.49249379308048],[20.88122479072204,40.5247234761692],[12.698403200653473,47.158582595790406],[54.239712600140955,-0.45790014746203533],[54.263737013784805,-0.4960419922338287],[54.297611047877965,-0.5434810348883781],[54.33449730207341,-0.5885784790027732],[54.37423603029385,-0.631140728941203],[54.416655211456195,-0.670985283088754],[54.461571314007024,-0.7079415218911371],[54.50879011100568,-0.7418514413349822],[54.558107541884674,-0.7725703285665407],[54.60931061676955,-0.7999673766446028],[54.66217835901505,-0.8239262357423652],[54.7164827814133,-0.8443454984483578],[54.77198989135692,-0.8611391171688688],[54.828460720097226,-0.8742367519977726],[54.88565237112816,-0.8835840477938937],[54.943319082651264,-0.8891428395858373],[55.001213299038724,-0.8908912858067208]]]}
         */
    }

    private void export(Geometry geom) {

        String execute2 = OperatorExportToGeoJson.local().execute(geom);
        System.out.println(execute2);
    }
}
